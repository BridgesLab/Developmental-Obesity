---
title: "pup.early.postnatal"
author: "Molly C. Mulcahy"
date: '2022-06-13'
output: html_document
---

```{r setup}

se <- function(x) sd(x, na.rm=T)/sqrt(length(x))

#load commonly needed packages
library(processx)
library(devtools)
library(tidyr)
library(dplyr)
library(readr)
library(ggplot2)
library(knitr)
library(car)
library(lme4)
library(broom)
library(forcats)

#set plot color scheme
color.scheme = c("#333333","#CCCCCC")
```


```{r data-entry}
pup.file<-"birth.data.csv"

pup.data<-read_csv(pup.file,
                   col_types = cols(
                     MouseID = col_factor(levels = NULL),
                     birth.weight = col_double(),
                     alive.at.birth = col_factor(levels =c("yes","no")),
                     gest.age = col_double(),
                     sex = col_factor(levels = c("male","female")),
                     survival = col_factor(levels =c("yes","no")),
                     culled = col_factor(levels =c("yes","no")),
                     Genotype = col_factor(levels = c("+/+","-/-"))
                   ))

```


```{r birth-weight}
#birth weight
birth.weight.data <-pup.data%>%
  filter(!(alive.at.birth =="no"))%>%
  group_by(MouseID, Genotype)%>%
  summarize(avg.bw =  mean(birth.weight))%>%
  group_by(Genotype)%>%
  summarize_at("avg.bw", funs(mean, se))

#plot
ggplot(birth.weight.data, aes(Genotype, mean, fill = Genotype))+
  geom_col(aes(fill = Genotype))+
  geom_errorbar(aes(ymin = mean -se, ymax = mean + se), width = 0.3)+
  scale_fill_manual(values = color.scheme)+
  labs(title = "Pup birth weight", y = "birth weight (grams)")+
  theme(legend.position = "none")

```


```{r gest-age}
#GA dataset 
GA.data<-pup.data%>%
  group_by(MouseID)%>%
  select(MouseID, Genotype, gest.age)%>%
  unique()%>%
  group_by(Genotype)%>%
  summarise_at(.var ="gest.age", .funs = funs(mean, se))
#plot
ggplot(GA.data, aes(Genotype, mean,fill = Genotype))+
  geom_col (aes(fill = Genotype))+
  geom_errorbar(aes(ymin = mean - se, ymax = mean + se), width = 0.3)+
  scale_fill_manual(values = color.scheme)+
  labs(title = "Gestational Age", y = "gestational age (days)")+
  theme(legend.position = "none")

```


```{r litter-size}


```